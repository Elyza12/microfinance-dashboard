<!DOCTYPE html>
<html>
<head>
<title>Payments</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-4">
<h2>Payments</h2>

<form id="paymentForm" class="row g-2 mb-3">
<div class="col">
<select class="form-select" id="loanSelect" required></select>
</div>
<div class="col">
<input type="number" id="paymentAmount" class="form-control" placeholder="Payment Amount" required>
</div>
<div class="col">
<button class="btn btn-success">Pay</button>
</div>
</form>

</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbzJPQZw9vc81-X2GzYKUB44tk7q7IJQJG7lfmVG8mAnjcBOED0Jn700WmH13-Zv2ZJTDQ/exec";

async function loadLoans(){
const res=await fetch(`${API_URL}?action=loans`);
const loans=await res.json();
loanSelect.innerHTML="";
loans.filter(l=>l.Status!=="Paid").forEach(l=>{
loanSelect.innerHTML+=`<option value="${l.LoanID}">${l.LoanID}</option>`;
});
}

paymentForm.addEventListener("submit",async e=>{
e.preventDefault();
await fetch(`${API_URL}?action=addPayment&loanId=${loanSelect.value}&amount=${paymentAmount.value}`);
paymentForm.reset();
alert("Payment successful");
});

loadLoans();
</script>

</body>
</html>
