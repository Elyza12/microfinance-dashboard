<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body>

<h2>Microfinance Dashboard</h2>

<button onclick="loadBorrowers()">Borrowers</button>
<button onclick="loadLoans()">Loans</button>

<div id="content"></div>

<script>
function loadBorrowers(){
  google.script.run.withSuccessHandler(function(data){
    let html = "<h3>Borrowers</h3>";
    html += "<button onclick='addBorrowerForm()'>Add Borrower</button><br><br>";
    html += "<table border=1><tr><th>Name</th><th>Phone</th><th>Action</th></tr>";

    for(let i=1;i<data.length;i++){
      html += `<tr>
      <td>${data[i][1]}</td>
      <td>${data[i][2]}</td>
      <td>
        <button onclick="editBorrower('${data[i][0]}','${data[i][1]}','${data[i][2]}','${data[i][3]}')">Edit</button>
      </td></tr>`;
    }

    html += "</table>";
    document.getElementById("content").innerHTML = html;
  }).getBorrowers();
}

function loadLoans(){
  google.script.run.withSuccessHandler(function(data){
    let html = "<h3>Loans</h3>";
    html += "<table border=1><tr><th>Borrower</th><th>Total</th><th>Balance</th><th>Due Date</th><th>Status</th></tr>";

    for(let i=1;i<data.length;i++){
      html += `<tr>
      <td>${data[i][2]}</td>
      <td>${data[i][6]}</td>
      <td>${data[i][10]}</td>
      <td>${new Date(data[i][8]).toLocaleDateString()}</td>
      <td>${data[i][9]}</td>
      </tr>`;
    }

    html += "</table>";
    document.getElementById("content").innerHTML = html;
  }).getLoans();
}
</script>

</body>
</html>
